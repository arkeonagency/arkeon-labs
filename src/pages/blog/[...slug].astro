---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import Seo from '../../components/Seo.jsx';

// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
  const posts = await getCollection('posts');
  return posts.map(entry => ({
    params: { slug: entry.slug }, props: { entry },
  }));
}

// 2. Get the entry from props
const { entry } = Astro.props;
const { Content } = await entry.render();
---

<BaseLayout>
  <Seo 
    title={entry.data.title}
    description={entry.data.description}
    image={entry.data.heroImage}
  />

  <article class="pt-32 pb-20">
    <div class="container mx-auto px-6 max-w-3xl">
      {/* Header */}
      <div class="text-center mb-12">
        <span class="text-arkeon-gold text-sm font-bold uppercase tracking-widest mb-4 block">
          {entry.data.pubDate}
        </span>
        <h1 class="text-4xl md:text-5xl font-serif font-bold mb-8 leading-tight">
          {entry.data.title}
        </h1>
        <div class="aspect-video w-full rounded-lg overflow-hidden mb-12">
           <img src={entry.data.heroImage} alt={entry.data.title} class="w-full h-full object-cover" />
        </div>
      </div>

      {/* Content (Prose) */}
      <div class="prose prose-invert prose-lg mx-auto prose-headings:font-serif prose-a:text-arkeon-gold hover:prose-a:text-white">
        <Content />
      </div>

      <div class="mt-12 pt-8 border-t border-white/10 text-center">
        <a href="/blog" class="text-sm font-bold text-gray-400 hover:text-white transition-colors">‚Üê Back to Insights</a>
      </div>
    </div>
  </article>
</BaseLayout>